<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Reproducible Finance with R</title>
  <meta name="description" content="A reproducible for Chapman &amp; Hall.">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Reproducible Finance with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A reproducible for Chapman &amp; Hall." />
  <meta name="github-repo" content="jkr216/reproducible-finance-ch" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Reproducible Finance with R" />
  
  <meta name="twitter:description" content="A reproducible for Chapman &amp; Hall." />
  

<meta name="author" content="Jonathan K. Regenstein, Jr.">


<meta name="date" content="2018-01-17">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="risk.html">
<link rel="next" href="rolling-standard-deviation.html">
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets/htmlwidgets.js"></script>
<script src="libs/proj4js/proj4.js"></script>
<link href="libs/highcharts/css/motion.css" rel="stylesheet" />
<script src="libs/highcharts/highstock.js"></script>
<script src="libs/highcharts/highcharts-3d.js"></script>
<script src="libs/highcharts/highcharts-more.js"></script>
<script src="libs/highcharts/modules/annotations.js"></script>
<script src="libs/highcharts/modules/broken-axis.js"></script>
<script src="libs/highcharts/modules/data.js"></script>
<script src="libs/highcharts/modules/drilldown.js"></script>
<script src="libs/highcharts/modules/exporting.js"></script>
<script src="libs/highcharts/modules/funnel.js"></script>
<script src="libs/highcharts/modules/heatmap.js"></script>
<script src="libs/highcharts/modules/map.js"></script>
<script src="libs/highcharts/modules/no-data-to-display.js"></script>
<script src="libs/highcharts/modules/offline-exporting.js"></script>
<script src="libs/highcharts/modules/solid-gauge.js"></script>
<script src="libs/highcharts/modules/treemap.js"></script>
<script src="libs/highcharts/plugins/annotations.js"></script>
<script src="libs/highcharts/plugins/draggable-legend.js"></script>
<script src="libs/highcharts/plugins/draggable-points.js"></script>
<script src="libs/highcharts/plugins/export-csv.js"></script>
<script src="libs/highcharts/plugins/grouped-categories.js"></script>
<script src="libs/highcharts/plugins/motion.js"></script>
<script src="libs/highcharts/plugins/pattern-fill-v2.js"></script>
<script src="libs/highcharts/plugins/tooltip-delay.js"></script>
<script src="libs/highcharts/custom/reset.js"></script>
<script src="libs/highcharts/custom/symbols-extra.js"></script>
<script src="libs/highcharts/custom/text-symbols.js"></script>
<link href="libs/fontawesome/font-awesome.min.css" rel="stylesheet" />
<link href="libs/htmlwdgtgrid/htmlwdgtgrid.css" rel="stylesheet" />
<script src="libs/highchart-binding/highchart.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> install the packages needed by this book; you fill out c(), e.g. c(‘ggplot2’, ‘dplyr’)</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-read-this-book"><i class="fa fa-check"></i>Why read this book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#structure-of-the-book"><i class="fa fa-check"></i>Structure of the book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i>About the Author</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-information-and-conventions"><i class="fa fa-check"></i>Software information and conventions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="returns.html"><a href="returns.html"><i class="fa fa-check"></i>Returns</a><ul>
<li class="chapter" data-level="" data-path="returns.html"><a href="returns.html#importing-asset-prices"><i class="fa fa-check"></i>Importing Asset Prices</a></li>
<li class="chapter" data-level="" data-path="returns.html"><a href="returns.html#thoughts-on-converting-daily-prices-to-monthly-log-returns"><i class="fa fa-check"></i>Thoughts on Converting Daily Prices to Monthly Log Returns</a></li>
<li><a href="returns.html#converting-daily-prices-to-monthly-returns-in-the-xts-world">Converting Daily Prices to Monthly Returns in the <code>xts</code> World</a></li>
<li class="chapter" data-level="" data-path="returns.html"><a href="returns.html#converting-daily-prices-to-monthly-returns-in-the-tidyverse"><i class="fa fa-check"></i>Converting Daily Prices to Monthly Returns in the Tidyverse</a></li>
<li><a href="returns.html#converting-daily-prices-to-monthly-returns-in-the-tidyquant-world">Converting Daily Prices to Monthly Returns in the <code>tidyquant</code> World</a></li>
<li class="chapter" data-level="" data-path="returns.html"><a href="returns.html#a-word-on-workflow-and-recap"><i class="fa fa-check"></i>A Word on workflow and recap</a></li>
<li class="chapter" data-level="" data-path="returns.html"><a href="returns.html#visualizing-asset-returns-before-they-get-mashed-into-a-portfolio"><i class="fa fa-check"></i>Visualizing Asset Returns before they get mashed into a portfolio</a></li>
<li><a href="returns.html#portfolio-returns-in-the-xts-world">Portfolio Returns in the <code>xts</code> world</a></li>
<li class="chapter" data-level="" data-path="returns.html"><a href="returns.html#portfolio-returns-in-the-tidyverse"><i class="fa fa-check"></i>Portfolio Returns in the tidyverse</a></li>
<li class="chapter" data-level="" data-path="returns.html"><a href="returns.html#portfolio-returns-in-the-tidyquant-world"><i class="fa fa-check"></i>Portfolio Returns in the tidyquant World</a></li>
<li class="chapter" data-level="" data-path="returns.html"><a href="returns.html#visualizing-portfolio-returns"><i class="fa fa-check"></i>Visualizing Portfolio Returns</a></li>
<li class="chapter" data-level="" data-path="returns.html"><a href="returns.html#our-first-shiny-app-portfolio-returns"><i class="fa fa-check"></i>Our First Shiny App: Portfolio Returns</a></li>
<li><a href="returns.html#portfolio-growth-in-the-xts-world">Portfolio Growth in the <code>xts</code> World</a></li>
<li class="chapter" data-level="" data-path="returns.html"><a href="returns.html#portfolio-growth-in-the-tidyverse"><i class="fa fa-check"></i>Portfolio Growth in the Tidyverse</a></li>
<li><a href="returns.html#portfolio-growth-in-the-tidyquant-world">Portfolio Growth in the <code>tidyquant</code> World</a></li>
<li class="chapter" data-level="" data-path="returns.html"><a href="returns.html#visualizing-portfolio-growth"><i class="fa fa-check"></i>Visualizing Portfolio Growth</a></li>
<li class="chapter" data-level="1.0.1" data-path="returns.html"><a href="returns.html#shiny-growth-of-a-dollar"><i class="fa fa-check"></i><b>1.0.1</b> Shiny Growth of a Dollar</a></li>
<li class="chapter" data-level="" data-path="returns.html"><a href="returns.html#concluding"><i class="fa fa-check"></i>Concluding</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="risk.html"><a href="risk.html"><i class="fa fa-check"></i>Risk</a></li>
<li class="chapter" data-level="2" data-path="portfolio-standard-deviation.html"><a href="portfolio-standard-deviation.html"><i class="fa fa-check"></i><b>2</b> Portfolio Standard Deviation</a><ul>
<li><a href="portfolio-standard-deviation.html#standard-deviation-in-the-xts-world">Standard Deviation in the <code>xts</code> World</a></li>
<li class="chapter" data-level="" data-path="portfolio-standard-deviation.html"><a href="portfolio-standard-deviation.html#standard-devation-in-the-tidyverse"><i class="fa fa-check"></i>Standard Devation in the Tidyverse</a></li>
<li class="chapter" data-level="" data-path="portfolio-standard-deviation.html"><a href="portfolio-standard-deviation.html#standard-deviation-in-the-tidyquant-world"><i class="fa fa-check"></i>Standard Deviation in the Tidyquant World</a></li>
<li class="chapter" data-level="" data-path="portfolio-standard-deviation.html"><a href="portfolio-standard-deviation.html#visualizing-standard-deviation"><i class="fa fa-check"></i>Visualizing Standard Deviation</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="rolling-standard-deviation.html"><a href="rolling-standard-deviation.html"><i class="fa fa-check"></i><b>3</b> Rolling Standard Deviation</a><ul>
<li class="chapter" data-level="3.0.1" data-path="rolling-standard-deviation.html"><a href="rolling-standard-deviation.html#rolling-standard-deviation-in-the-xts-world"><i class="fa fa-check"></i><b>3.0.1</b> Rolling Standard Deviation in the <code>xts</code> world</a></li>
<li class="chapter" data-level="3.0.2" data-path="rolling-standard-deviation.html"><a href="rolling-standard-deviation.html#rolling-standard-deviation-in-tidyverse"><i class="fa fa-check"></i><b>3.0.2</b> Rolling Standard Deviation in tidyverse</a></li>
<li class="chapter" data-level="" data-path="rolling-standard-deviation.html"><a href="rolling-standard-deviation.html#rolling-standard-deviation-with-tidyquant"><i class="fa fa-check"></i>Rolling Standard Deviation with tidyquant</a></li>
<li><a href="rolling-standard-deviation.html#visualizing-rolling-standard-deviation-in-the-xts-world">Visualizing Rolling Standard Deviation in the <code>xts</code> world</a></li>
<li class="chapter" data-level="" data-path="rolling-standard-deviation.html"><a href="rolling-standard-deviation.html#visualizing-rolling-standard-deviation-in-the-tidyverse"><i class="fa fa-check"></i>Visualizing Rolling Standard Deviation in the Tidyverse</a></li>
<li class="chapter" data-level="" data-path="rolling-standard-deviation.html"><a href="rolling-standard-deviation.html#shiny-app"><i class="fa fa-check"></i>Shiny App</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="component-contribution-to-volatility.html"><a href="component-contribution-to-volatility.html"><i class="fa fa-check"></i><b>4</b> Component Contribution to Volatility</a><ul>
<li class="chapter" data-level="" data-path="component-contribution-to-volatility.html"><a href="component-contribution-to-volatility.html#visualizing-component-contribution"><i class="fa fa-check"></i>Visualizing Component Contribution</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="rolling-component-contribution-to-volatility.html"><a href="rolling-component-contribution-to-volatility.html"><i class="fa fa-check"></i><b>5</b> Rolling Component Contribution to Volatility</a><ul>
<li class="chapter" data-level="" data-path="rolling-component-contribution-to-volatility.html"><a href="rolling-component-contribution-to-volatility.html#visualizing-component-contribution-to-volatility"><i class="fa fa-check"></i>Visualizing Component Contribution to Volatility</a></li>
<li class="chapter" data-level="" data-path="rolling-component-contribution-to-volatility.html"><a href="rolling-component-contribution-to-volatility.html#shiny-component-contribution"><i class="fa fa-check"></i>Shiny Component Contribution</a></li>
<li class="chapter" data-level="" data-path="rolling-component-contribution-to-volatility.html"><a href="rolling-component-contribution-to-volatility.html#conclusion-on-standard-deviation"><i class="fa fa-check"></i>Conclusion on Standard Deviation</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="portfolio-theory.html"><a href="portfolio-theory.html"><i class="fa fa-check"></i><b>6</b> Portfolio Theory</a></li>
<li class="chapter" data-level="7" data-path="montecarlo.html"><a href="montecarlo.html"><i class="fa fa-check"></i><b>7</b> montecarlo</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="more-to-say.html"><a href="more-to-say.html"><i class="fa fa-check"></i><b>A</b> More to Say</a></li>
<li class="chapter" data-level="" data-path="appendix-2.html"><a href="appendix-2.html"><i class="fa fa-check"></i>Appendix 2</a></li>
<li class="chapter" data-level="B" data-path="generate-a-bibtex-database-automatically-for-some-r-packages.html"><a href="generate-a-bibtex-database-automatically-for-some-r-packages.html"><i class="fa fa-check"></i><b>B</b> generate a BibTeX database automatically for some R packages</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Reproducible Finance with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="portfolio-standard-deviation" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Portfolio Standard Deviation</h1>
<p>Let’s start with the textbook equation for the standard deviation of a multi-asset portfolio.</p>
<p>Here is the Latex code for the equation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">$</span><span class="er">$</span>Standard<span class="op">~</span>Deviation=\sqrt{\sum_{t=<span class="dv">1</span>}<span class="op">^</span><span class="kw">n</span> (x_i<span class="op">-</span>\overline{x})<span class="op">^</span><span class="dv">2</span><span class="op">/</span>n}<span class="op">$</span><span class="er">$</span></code></pre></div>
<p>And here is the output</p>
<p><span class="math display">\[Standard~Deviation=\sqrt{\sum_{t=1}^n (x_i-\overline{x})^2/n}\]</span> where x is each monthly portfolio return and x-bar is the mean monthly portfolio return. For a multi-asset portfolio, the equation is not simply the weighted variances of each asset. Instead, it’s the weight squared of each asset multiplied by that asset’s variance, plus the covariance of each asset times the weights of those assets.</p>
<p>Here is the Latex code for the equation</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">$</span><span class="er">$</span>Standard<span class="op">~</span>Deviation=<span class="er">$$</span>
<span class="er">$$</span>w_{asset1}<span class="op">^</span>{<span class="dv">2</span>} <span class="op">*</span><span class="st"> </span>var_{asset1} <span class="op">~+</span><span class="er">~</span><span class="st"> </span>w_{asset2}<span class="op">^</span>{<span class="dv">2</span>} <span class="op">*</span><span class="st"> </span>var_{asset2} <span class="op">~+</span><span class="er">~$$</span><span class="st">     </span>
<span class="er">$$</span>w_{asset3}<span class="op">^</span>{<span class="dv">2</span>} <span class="op">*</span><span class="st"> </span>var_{asset3} <span class="op">~+</span><span class="er">~</span><span class="st"> </span>w_{asset4}<span class="op">^</span>{<span class="dv">2</span>} <span class="op">*</span><span class="st"> </span>var_{asset4} <span class="op">~+</span><span class="er">~$$</span><span class="st">      </span>
<span class="er">$$</span>w_{asset5}<span class="op">^</span>{<span class="dv">2</span>} <span class="op">*</span><span class="st"> </span>var_{asset5} <span class="op">~+</span><span class="er">~</span><span class="st"> </span>w_{asset1}<span class="op">*</span>w_{asset_<span class="dv">2</span>}<span class="op">*</span>cov_{asset <span class="dv">1</span>, <span class="op">~</span>asset <span class="dv">2</span>} <span class="op">~+</span><span class="er">~$$</span><span class="st">      </span>
<span class="er">$$</span>w_{asset1}<span class="op">*</span>w_{asset_<span class="dv">3</span>}<span class="op">*</span>cov_{asset <span class="dv">1</span>, <span class="op">~</span>asset <span class="dv">3</span>} <span class="op">~+</span><span class="er">~$$</span>
<span class="er">$$</span>w_{asset1}<span class="op">*</span>w_{asset_<span class="dv">4</span>}<span class="op">*</span>cov_{asset <span class="dv">1</span>, <span class="op">~</span>asset <span class="dv">4</span>} <span class="op">~+</span><span class="er">~$$</span>
<span class="er">$$</span>w_{asset1}<span class="op">*</span>w_{asset_<span class="dv">5</span>}<span class="op">*</span>cov_{asset <span class="dv">1</span>, <span class="op">~</span>asset <span class="dv">5</span>} <span class="op">~+</span><span class="er">~$$</span>
<span class="er">$$</span>w_{asset2}<span class="op">*</span>w_{asset_<span class="dv">3</span>}<span class="op">*</span>cov_{asset <span class="dv">2</span>, <span class="op">~</span>asset <span class="dv">3</span>} <span class="op">~+</span><span class="er">~$$</span>
<span class="er">$$</span>w_{asset2}<span class="op">*</span>w_{asset_<span class="dv">4</span>}<span class="op">*</span>cov_{asset <span class="dv">2</span>, <span class="op">~</span>asset <span class="dv">4</span>} <span class="op">~+</span><span class="er">~$$</span>
<span class="er">$$</span>w_{asset2}<span class="op">*</span>w_{asset_<span class="dv">5</span>}<span class="op">*</span>cov_{asset <span class="dv">2</span>, <span class="op">~</span>asset <span class="dv">5</span>} <span class="op">~+</span><span class="er">~$$</span>
<span class="er">$$</span>w_{asset3}<span class="op">*</span>w_{asset_<span class="dv">4</span>}<span class="op">*</span>cov_{asset <span class="dv">3</span>, <span class="op">~</span>asset <span class="dv">4</span>} <span class="op">~+</span><span class="er">~$$</span>
<span class="er">$$</span>w_{asset3}<span class="op">*</span>w_{asset_<span class="dv">5</span>}<span class="op">*</span>cov_{asset <span class="dv">3</span>, <span class="op">~</span>asset <span class="dv">5</span>} <span class="op">~+</span><span class="er">~$$</span>
<span class="er">$$</span>w_{asset4}<span class="op">*</span>w_{asset_<span class="dv">5</span>}<span class="op">*</span>cov_{asset <span class="dv">4</span>, <span class="op">~</span>asset <span class="dv">5</span>}<span class="op">$</span><span class="er">$</span></code></pre></div>
<p>Here is that equation for a 5-asset portfolio.</p>
<p><span class="math display">\[Standard~Deviation=\]</span> <span class="math display">\[w_{asset1}^{2} * var_{asset1} ~+~ w_{asset2}^{2} * var_{asset2} ~+~\]</span><br />
<span class="math display">\[w_{asset3}^{2} * var_{asset3} ~+~ w_{asset4}^{2} * var_{asset4} ~+~\]</span><br />
<span class="math display">\[w_{asset5}^{2} * var_{asset5} ~+~ w_{asset1}*w_{asset_2}*cov_{asset 1, ~asset 2} ~+~\]</span><br />
<span class="math display">\[w_{asset1}*w_{asset_3}*cov_{asset 1, ~asset 3} ~+~\]</span> <span class="math display">\[w_{asset1}*w_{asset_4}*cov_{asset 1, ~asset 4} ~+~\]</span> <span class="math display">\[w_{asset1}*w_{asset_5}*cov_{asset 1, ~asset 5} ~+~\]</span> <span class="math display">\[w_{asset2}*w_{asset_3}*cov_{asset 2, ~asset 3} ~+~\]</span> <span class="math display">\[w_{asset2}*w_{asset_4}*cov_{asset 2, ~asset 4} ~+~\]</span> <span class="math display">\[w_{asset2}*w_{asset_5}*cov_{asset 2, ~asset 5} ~+~\]</span> <span class="math display">\[w_{asset3}*w_{asset_4}*cov_{asset 3, ~asset 4} ~+~\]</span> <span class="math display">\[w_{asset3}*w_{asset_5}*cov_{asset 3, ~asset 5} ~+~\]</span> <span class="math display">\[w_{asset4}*w_{asset_5}*cov_{asset 4, ~asset 5}\]</span></p>
<p>Now, let’s use that equation and calculate portfolio standard deviation by-hand. This is not for the faint of heart.</p>
<p>First, we assign the weights of each asset, based on the <code>w</code> vector we created earlier in the Returns section.</p>
<p>Then, we isolate and assign returns of each asset from <code>asset_returns_xts</code> and plug those weights and returns into the equation for portfolio standard deviation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">w_<span class="dv">1</span> &lt;-<span class="st"> </span>w[<span class="dv">1</span>]
w_<span class="dv">2</span> &lt;-<span class="st"> </span>w[<span class="dv">2</span>]
w_<span class="dv">3</span> &lt;-<span class="st"> </span>w[<span class="dv">3</span>]
w_<span class="dv">4</span> &lt;-<span class="st"> </span>w[<span class="dv">4</span>]
w_<span class="dv">5</span> &lt;-<span class="st"> </span>w[<span class="dv">5</span>]

asset1 &lt;-<span class="st"> </span>asset_returns_xts[,<span class="dv">1</span>]
asset2 &lt;-<span class="st"> </span>asset_returns_xts[,<span class="dv">2</span>]
asset3 &lt;-<span class="st"> </span>asset_returns_xts[,<span class="dv">3</span>]
asset4 &lt;-<span class="st"> </span>asset_returns_xts[,<span class="dv">4</span>]
asset5 &lt;-<span class="st"> </span>asset_returns_xts[,<span class="dv">5</span>]
 

sd_by_hand &lt;-<span class="st">  </span>
<span class="st">  </span><span class="kw">sqrt</span>(
  (w_<span class="dv">1</span><span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(asset1)) <span class="op">+</span><span class="st"> </span>(w_<span class="dv">2</span><span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(asset2)) <span class="op">+</span><span class="st"> </span>(w_<span class="dv">3</span><span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(asset3)) <span class="op">+</span>
<span class="st">  </span>(w_<span class="dv">4</span><span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(asset4)) <span class="op">+</span><span class="st"> </span>(w_<span class="dv">5</span><span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(asset5)) <span class="op">+</span>
<span class="st">  </span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>w_<span class="dv">1</span> <span class="op">*</span><span class="st"> </span>w_<span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">cov</span>(asset1, asset2)) <span class="op">+</span><span class="st">  </span>
<span class="st">  </span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>w_<span class="dv">1</span> <span class="op">*</span><span class="st"> </span>w_<span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="kw">cov</span>(asset1, asset3)) <span class="op">+</span>
<span class="st">  </span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>w_<span class="dv">1</span> <span class="op">*</span><span class="st"> </span>w_<span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="kw">cov</span>(asset1, asset4)) <span class="op">+</span>
<span class="st">  </span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>w_<span class="dv">1</span> <span class="op">*</span><span class="st"> </span>w_<span class="dv">5</span> <span class="op">*</span><span class="st"> </span><span class="kw">cov</span>(asset1, asset5)) <span class="op">+</span>
<span class="st">  </span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>w_<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>w_<span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="kw">cov</span>(asset2, asset3)) <span class="op">+</span>
<span class="st">  </span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>w_<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>w_<span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="kw">cov</span>(asset2, asset4)) <span class="op">+</span>
<span class="st">  </span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>w_<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>w_<span class="dv">5</span> <span class="op">*</span><span class="st"> </span><span class="kw">cov</span>(asset2, asset5)) <span class="op">+</span>
<span class="st">  </span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>w_<span class="dv">3</span> <span class="op">*</span><span class="st"> </span>w_<span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="kw">cov</span>(asset3, asset4)) <span class="op">+</span>
<span class="st">  </span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>w_<span class="dv">3</span> <span class="op">*</span><span class="st"> </span>w_<span class="dv">5</span> <span class="op">*</span><span class="st"> </span><span class="kw">cov</span>(asset3, asset5)) <span class="op">+</span>
<span class="st">  </span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>w_<span class="dv">4</span> <span class="op">*</span><span class="st"> </span>w_<span class="dv">5</span> <span class="op">*</span><span class="st"> </span><span class="kw">cov</span>(asset4, asset5))
  )

sd_by_hand</code></pre></div>
<pre><code>##         SPY
## SPY 0.02666</code></pre>
<p>It’s nice to display this number as percentage in the investment world.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sd_by_hand_percent &lt;-<span class="st"> </span><span class="kw">round</span>(sd_by_hand <span class="op">*</span><span class="st"> </span><span class="dv">100</span>, <span class="dv">2</span>)</code></pre></div>
<p>Writing that equation out was painful but at least we won’t be forgetting it any time soon. Our result is a monthly portfolio returns standard deviation of 2.67%.</p>
<p>Now let’s turn to the less verbose matrix algebra path and confirm that we get the same result.</p>
<p>First, we will build a covariance matrix of returns using the <code>cov()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">covariance_matrix &lt;-<span class="st"> </span><span class="kw">cov</span>(asset_returns_xts)
covariance_matrix</code></pre></div>
<pre><code>##            SPY       EFA        IJS       EEM        AGG
## SPY  7.292e-04 6.894e-04  8.171e-04 0.0006968 -3.952e-06
## EFA  6.894e-04 1.066e-03  6.386e-04 0.0010607  4.671e-05
## IJS  8.171e-04 6.386e-04  1.564e-03 0.0006591 -7.379e-05
## EEM  6.968e-04 1.061e-03  6.591e-04 0.0017869  1.052e-04
## AGG -3.952e-06 4.671e-05 -7.379e-05 0.0001052  7.412e-05</code></pre>
<p>Have a look at the covariance matrix.</p>
<p>AGG, the US bond ETF, has a negative or very low covariance with the other ETFs and it should make a nice volatility dampener. Interestingly, the covariance between EEM and EFA is quite low as well. Our painstakingly written-out equation above is a good reminder of how low covariances affect total portfolio standard deviation, and how negative covariances can really lower total portfolio standard deviation.</p>
<p>Back to our calculation, let’s take the square root of the transpose of the weights vector times the covariance matrix times the weights vector. To perform matrix multiplcation, we use <code>%*%</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sd_matrix_algebra &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">t</span>(w) <span class="op">%*%</span><span class="st"> </span>covariance_matrix <span class="op">%*%</span><span class="st"> </span>w)

sd_matrix_algebra_percent &lt;-<span class="st"> </span><span class="kw">round</span>(sd_matrix_algebra <span class="op">*</span><span class="st"> </span><span class="dv">100</span>, <span class="dv">2</span>)

sd_by_hand_percent</code></pre></div>
<pre><code>##      SPY
## SPY 2.67</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sd_matrix_algebra_percent</code></pre></div>
<pre><code>##      [,1]
## [1,] 2.67</code></pre>
<p>Have a look at our two standard deviation calculations Thankfully, these return the same result so we don’t have to sort through the by-hand equation again.</p>
<div id="standard-deviation-in-the-xts-world" class="section level3 unnumbered">
<h3>Standard Deviation in the <code>xts</code> World</h3>
<p>In the <code>xts</code> paradigm, we can use the built-in <code>StdDev()</code> function from <code>PerformanceAnalytics</code> to go straight from asset returns to portfolio standard deviation. It takes two arguments, a vector of returns and weights: <code>StdDev(asset_returns_xts, weights = w)</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">portfolio_sd_xts_builtin &lt;-<span class="st"> </span><span class="kw">StdDev</span>(asset_returns_xts, <span class="dt">weights =</span> w)


portfolio_sd_xts_builtin_percent &lt;-<span class="st"> </span><span class="kw">round</span>(portfolio_sd_xts_builtin <span class="op">*</span><span class="st"> </span><span class="dv">100</span>, <span class="dv">2</span>)</code></pre></div>
<p>We now have:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sd_by_hand_percent</code></pre></div>
<pre><code>##      SPY
## SPY 2.67</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sd_matrix_algebra_percent</code></pre></div>
<pre><code>##      [,1]
## [1,] 2.67</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">portfolio_sd_xts_builtin_percent</code></pre></div>
<pre><code>##      [,1]
## [1,] 2.67</code></pre>
</div>
<div id="standard-devation-in-the-tidyverse" class="section level3 unnumbered">
<h3>Standard Devation in the Tidyverse</h3>
<p>Now let’s head to the tidyverse and explore the code flow.</p>
<p>We will start with the portfolio returns object <code>portfolio_returns_tq_rebalanced_monthly</code> and use the <code>summarise()</code> function from <code>dplyr</code> and then the base function <code>sd()</code>. We will also perform the calculation with our own equation <code>sqrt(sum((returns - mean(returns))^2)/(nrow(.)-1)))</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">portfolio_sd_tidy_builtin_percent &lt;-
<span class="st">  </span>portfolio_returns_tq_rebalanced_monthly <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">sd =</span> <span class="kw">sd</span>(returns),
            <span class="dt">sd_byhand =</span> <span class="kw">sqrt</span>(<span class="kw">sum</span>((returns <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(returns))<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(<span class="kw">nrow</span>(.)<span class="op">-</span><span class="dv">1</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sd =</span> <span class="kw">round</span>(sd, <span class="dv">4</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>,
         <span class="dt">sd_byhand =</span> <span class="kw">round</span>(sd_byhand, <span class="dv">4</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>)  <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(sd, sd_byhand)

portfolio_sd_tidy_builtin_percent  </code></pre></div>
<pre><code>## # A tibble: 1 x 2
##      sd sd_byhand
##   &lt;dbl&gt;     &lt;dbl&gt;
## 1  2.67      2.67</code></pre>
</div>
<div id="standard-deviation-in-the-tidyquant-world" class="section level3 unnumbered">
<h3>Standard Deviation in the Tidyquant World</h3>
<p>In the code flow below, we’ll invoke the <code>table.Stats()</code> function from <code>PerformanceAnalytics</code> but use <code>tq_performance</code> to apply it to a data frame. The <code>table.Stats()</code> function retuns a table of statistics for the portfolio but since we want only standard deviation, we will use the <code>dplyr</code> verb <code>select()</code> to get just the <code>Stdev</code> column.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">portfolio_sd_tidyquant_builtin_percent &lt;-<span class="st"> </span>
portfolio_returns_tq_rebalanced_monthly <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tq_performance</span>(<span class="dt">Ra =</span> returns, <span class="dt">Rb =</span> <span class="ot">NULL</span>, <span class="dt">performance_fun =</span> table.Stats) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(Stdev) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Stdev =</span> <span class="kw">round</span>(Stdev, <span class="dv">4</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>)

portfolio_sd_tidyquant_builtin_percent<span class="op">$</span>Stdev</code></pre></div>
<pre><code>## [1] 2.67</code></pre>
<p>In general, this demonstrates one of the fantastic ways that tidyquant blends together the <code>xts</code> and tidy paradigms. Here it lets us grab a function from <code>PerformanceAnalytics</code> and use a piped workflow to apply it to a data frame.</p>
<p>Let’s review our calculations thus far.</p>
<ul>
<li>by-hand calculation = 2.67%</li>
<li>matrix algebra calculation = 2.67%</li>
<li>xts built in function calculation = 2.67%</li>
<li>tidy built in function calculation = 2.67%</li>
<li>tidy by hand calculation = 2.67%</li>
<li>tidyquant built-in function calculation = 2.67</li>
</ul>
<p>That was quite a lot of work to confirm that 6 calculations are equal to each other but there are a few benefits.</p>
<p>First, while it was tedious, we should feel comfortable with calculating portfolio standard deviations in various ways and starting from different object types. That can be useful when an external team or client dumps data on us and that data has a weird (to us, it’s probably normal to them) format.</p>
<p>More importantly, as our work gets more complicated and we build custom functions, we’ll want to rely on the built-in <code>StdDev()</code> function and the built-in tidy workflow. We’ll also want to manipulate data and slice/dice things for rolling calculations. Our tedious work here, where we used different flows and functions by choice, will facilitate our future work when we need to solve harder coding challenges.</p>
<p>Beyond helping our own work, it can help our colleagues to understand the more complex work if we can point back to this starter code flow on standard deviation.</p>
</div>
<div id="visualizing-standard-deviation" class="section level3 unnumbered">
<h3>Visualizing Standard Deviation</h3>
<p>Visualizing volatility really involves visualizing reuturns, as we have already done, but trying to put an emphasis on the dispersion of the returns.</p>
<p>Here is the scatter plot of monthly returns that we built in the previous section.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">portfolio_returns_tq_rebalanced_monthly <span class="op">%&gt;%</span>

<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> date, <span class="dt">y =</span> returns)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">color =</span> <span class="st">&quot;cornflowerblue&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_date</span>(<span class="dt">breaks =</span> <span class="kw">pretty_breaks</span>(<span class="dt">n =</span> <span class="dv">8</span>)) </code></pre></div>
<p><img src="bookdown_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Hard to discern much here with respect to volatility, though we can notice that the year 2017 had consistently positive monthly returns. Let’s add some more indicators.</p>
<p>It might be nice to have a different color for any monthly returns that are, say, one standard deviation away from the mean. First, we will create an indicator for the mean return with <code>mean(portfolio_returns_tq_rebalanced_monthly$returns)</code> and one for the standard deviation with <code>sd(portfolio_returns_tq_rebalanced_monthly$returns)</code>. We will call the variables <code>mean_plot</code> and <code>sd_plot</code> since we plan to use them in a plot and not for anything else.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sd_plot &lt;-<span class="st"> </span><span class="kw">sd</span>(portfolio_returns_tq_rebalanced_monthly<span class="op">$</span>returns)
mean_plot &lt;-<span class="st"> </span><span class="kw">mean</span>(portfolio_returns_tq_rebalanced_monthly<span class="op">$</span>returns)</code></pre></div>
<p>We want to shade the scatter points according to some logic, in this case their distance from the standard deviation of returns. Accordingly, we’ll use <code>mutate()</code> to create three columns of returns.</p>
<p>We will nest a call to <code>ifelse()</code> because these new columns are populated according to ifelse logic. If the return observation is one standard deviation below the mean, we want to add that observation to the column we call <code>hist_col_red</code>, else that column should have an NA. We will create three new columns this way.</p>
<p>This nested <code>ifelse()</code> logic is similar to how we calculated portfolio returns by-hand in Section 1. It’s an important tool in finance.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">portfolio_returns_tq_rebalanced_monthly <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">hist_col_red =</span> 
           <span class="kw">ifelse</span>(returns <span class="op">&lt;</span><span class="st"> </span>(mean_plot <span class="op">-</span><span class="st"> </span>sd_plot), 
                  returns, <span class="ot">NA</span>),
         <span class="dt">hist_col_green =</span> 
           <span class="kw">ifelse</span>(returns <span class="op">&gt;</span><span class="st"> </span>(mean_plot <span class="op">+</span><span class="st"> </span>sd_plot), 
                  returns, <span class="ot">NA</span>),
         <span class="dt">hist_col_blue =</span> 
           <span class="kw">ifelse</span>(returns <span class="op">&gt;</span><span class="st"> </span>(mean_plot <span class="op">-</span><span class="st"> </span>sd_plot) <span class="op">&amp;</span>
<span class="st">                  </span>returns <span class="op">&lt;</span><span class="st"> </span>(mean_plot <span class="op">+</span><span class="st"> </span>sd_plot),
                  returns, <span class="ot">NA</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> date)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y =</span> hist_col_red),
               <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span>
<span class="st">  </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y =</span> hist_col_green),
               <span class="dt">color =</span> <span class="st">&quot;green&quot;</span>) <span class="op">+</span>
<span class="st">  </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y =</span> hist_col_blue),
               <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>)</code></pre></div>
<pre><code>## Warning: Removed 50 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 51 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 17 rows containing missing values (geom_point).</code></pre>
<p><img src="bookdown_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>That visualization gives a little more intuition about the dispersion, we can see about how many red and green dots appear there.</p>
<p>Let’s add a line for the value that is one standard deviation above and below the mean with <code>geom_hline(yintercept = (mean_plot + sd_plot), color = &quot;purple&quot;, linetype = &quot;dotted&quot;) +</code> <code>geom_hline(yintercept = (mean_plot-sd_plot), color = &quot;purple&quot;, linetype = &quot;dotted&quot;) +</code>.</p>
<p>The <code>geom_hline()</code> function from <code>ggplot</code> adds a horizontal line to the chart.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">portfolio_returns_tq_rebalanced_monthly <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">hist_col_red =</span> 
           <span class="kw">ifelse</span>(returns <span class="op">&lt;</span><span class="st"> </span>(mean_plot <span class="op">-</span><span class="st"> </span>sd_plot), 
                  returns, <span class="ot">NA</span>),
         <span class="dt">hist_col_green =</span> 
           <span class="kw">ifelse</span>(returns <span class="op">&gt;</span><span class="st"> </span>(mean_plot <span class="op">+</span><span class="st"> </span>sd_plot), 
                  returns, <span class="ot">NA</span>),
         <span class="dt">hist_col_blue =</span> 
           <span class="kw">ifelse</span>(returns <span class="op">&gt;</span><span class="st"> </span>(mean_plot <span class="op">-</span><span class="st"> </span>sd_plot) <span class="op">&amp;</span>
<span class="st">                  </span>returns <span class="op">&lt;</span><span class="st"> </span>(mean_plot <span class="op">+</span><span class="st"> </span>sd_plot),
                  returns, <span class="ot">NA</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> date)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y =</span> hist_col_red),
               <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span>
<span class="st">  </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y =</span> hist_col_green),
               <span class="dt">color =</span> <span class="st">&quot;green&quot;</span>) <span class="op">+</span>
<span class="st">  </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y =</span> hist_col_blue),
               <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span>
<span class="st">  </span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> (mean_plot <span class="op">+</span><span class="st"> </span>sd_plot), <span class="dt">color =</span> <span class="st">&quot;purple&quot;</span>, <span class="dt">linetype =</span> <span class="st">&quot;dotted&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> (mean_plot<span class="op">-</span>sd_plot), <span class="dt">color =</span> <span class="st">&quot;purple&quot;</span>, <span class="dt">linetype =</span> <span class="st">&quot;dotted&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_date</span>(<span class="dt">breaks =</span> <span class="kw">pretty_breaks</span>(<span class="dt">n =</span> <span class="dv">8</span>)) <span class="op">+</span>
<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;percent monthly returns&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Monthly Returns Shaded by Distance from Mean&quot;</span>)</code></pre></div>
<pre><code>## Warning: Removed 50 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 51 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 17 rows containing missing values (geom_point).</code></pre>
<p><img src="bookdown_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>This is showing us returns over time and whether they fall below or above one standard deviation from the mean. One thing that jumps out is how many red or green circles we see after 2017. 0! That’s zero monthly returns that are least one standard deviation from the mean during calendar year 2017 (Is 2017 a year of very low volatility or did we construct an amazingly stable porftolio? Check out the VIX during 2017!). When we get to rolling volatility, we should see this reflected as a low rolling volatility through 2017. If we something different, we need to investigate.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="risk.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="rolling-standard-deviation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/yihui/bookdown-crc/edit/master/risk.Rmd",
"text": "Edit"
},
"download": ["bookdown.pdf", "bookdown.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
